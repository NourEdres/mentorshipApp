{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\MentorshipApp\\\\client\\\\src\\\\CodeBlockPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { useUser } from './UserContext';\nimport { LightAsync as SyntaxHighlighter } from 'react-syntax-highlighter';\nimport { docco } from 'react-syntax-highlighter/dist/esm/styles/hljs';\nimport io from 'socket.io-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CodeBlockPage = () => {\n  _s();\n  const [code, setCode] = useState('');\n  const [title, setTitle] = useState('');\n  const [correctCode, setCorrectCode] = useState('');\n  const [error, setError] = useState(null);\n  const [isTyping, setIsTyping] = useState(false); // State for typing indicator\n  const {\n    user\n  } = useUser();\n  const {\n    id\n  } = useParams();\n  const [socket, setSocket] = useState(null);\n  useEffect(() => {\n    const newSocket = io('https://mentorship-app.onrender.com');\n    setSocket(newSocket);\n    const fetchCodeBlock = async () => {\n      try {\n        const response = await fetch(`https://mentorship-app.onrender.com/api/codeblocks/${id}`);\n        if (!response.ok) {\n          throw new Error('Network response was not ok');\n        }\n        const data = await response.json();\n        setCode(data.code);\n        setTitle(data.title);\n        setCorrectCode(data.correctCode);\n      } catch (error) {\n        setError(error);\n      }\n    };\n    fetchCodeBlock();\n    newSocket.on('codeUpdated', updatedCode => {\n      setCode(updatedCode);\n    });\n    newSocket.on('typing', () => {\n      setIsTyping(true);\n      setTimeout(() => setIsTyping(false), 2000);\n    });\n    return () => {\n      newSocket.off('codeUpdated');\n      newSocket.off('typing');\n      newSocket.disconnect();\n    };\n  }, [id]);\n  const handleSave = async () => {\n    if (user.role !== 'Mentor') {\n      try {\n        const response = await fetch(`https://mentorship-app.onrender.com/api/codeblocks/${id}`, {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            title,\n            code\n          })\n        });\n        if (!response.ok) {\n          const errorText = await response.text();\n          throw new Error(`Network response was not ok: ${errorText}`);\n        }\n        console.log('Code block updated successfully');\n        if (socket && socket.connected) {\n          socket.emit('updateCode', {\n            code\n          });\n        }\n        checkCorrectCode();\n      } catch (error) {\n        console.error('Error updating code block:', error);\n        setError(error.message);\n      }\n    }\n  };\n  const checkCorrectCode = async () => {\n    const celebrationSpan = document.querySelector('.material-symbols-outlined');\n    if (code === correctCode) {\n      if (!celebrationSpan) {\n        const newSpan = document.createElement('span');\n        newSpan.classList.add('material-symbols-outlined');\n        newSpan.textContent = \"celebration\";\n        document.body.appendChild(newSpan);\n        setTimeout(() => {\n          newSpan.remove();\n        }, 2000);\n      }\n    } else {\n      if (celebrationSpan) {\n        celebrationSpan.remove();\n      }\n    }\n  };\n  const handleCodeChange = e => {\n    const updatedCode = e.target.value;\n    setCode(updatedCode);\n    if (user.role !== 'Mentor') {\n      socket.emit('typing');\n      socket.emit('updateCode', {\n        code: updatedCode\n      });\n    }\n  };\n  if (error) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"Error loading code block.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 112,\n    columnNumber: 23\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Code Block\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n      children: title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }, this), user.role === 'Mentor' ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(SyntaxHighlighter, {\n        language: \"javascript\",\n        style: docco,\n        children: code\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 21\n      }, this), isTyping && /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"The mentee is typing...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 34\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        rows: \"10\",\n        cols: \"50\",\n        value: code,\n        onChange: handleCodeChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSave,\n        children: \"Save Changes\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 115,\n    columnNumber: 9\n  }, this);\n};\n_s(CodeBlockPage, \"Ktql0HIalsnZt3Gjnt0/7z3vaI0=\", false, function () {\n  return [useUser, useParams];\n});\n_c = CodeBlockPage;\nexport default CodeBlockPage;\nvar _c;\n$RefreshReg$(_c, \"CodeBlockPage\");","map":{"version":3,"names":["React","useState","useEffect","useParams","useUser","LightAsync","SyntaxHighlighter","docco","io","jsxDEV","_jsxDEV","CodeBlockPage","_s","code","setCode","title","setTitle","correctCode","setCorrectCode","error","setError","isTyping","setIsTyping","user","id","socket","setSocket","newSocket","fetchCodeBlock","response","fetch","ok","Error","data","json","on","updatedCode","setTimeout","off","disconnect","handleSave","role","method","headers","body","JSON","stringify","errorText","text","console","log","connected","emit","checkCorrectCode","message","celebrationSpan","document","querySelector","newSpan","createElement","classList","add","textContent","appendChild","remove","handleCodeChange","e","target","value","children","fileName","_jsxFileName","lineNumber","columnNumber","language","style","rows","cols","onChange","onClick","_c","$RefreshReg$"],"sources":["C:/Users/user/Desktop/MentorshipApp/client/src/CodeBlockPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { useUser } from './UserContext';\r\nimport { LightAsync as SyntaxHighlighter } from 'react-syntax-highlighter';\r\nimport { docco } from 'react-syntax-highlighter/dist/esm/styles/hljs';\r\nimport io from 'socket.io-client';\r\n\r\nconst CodeBlockPage = () => {\r\n    const [code, setCode] = useState('');\r\n    const [title, setTitle] = useState('');\r\n    const [correctCode, setCorrectCode] = useState('');\r\n    const [error, setError] = useState(null);\r\n    const [isTyping, setIsTyping] = useState(false); // State for typing indicator\r\n    const { user } = useUser();\r\n    const { id } = useParams();\r\n    const [socket, setSocket] = useState(null);\r\n\r\n    useEffect(() => {\r\n        const newSocket = io('https://mentorship-app.onrender.com');\r\n        setSocket(newSocket);\r\n\r\n        const fetchCodeBlock = async () => {\r\n            try {\r\n                const response = await fetch(`https://mentorship-app.onrender.com/api/codeblocks/${id}`);\r\n                if (!response.ok) {\r\n                    throw new Error('Network response was not ok');\r\n                }\r\n                const data = await response.json();\r\n                setCode(data.code);\r\n                setTitle(data.title);\r\n                setCorrectCode(data.correctCode);\r\n            } catch (error) {\r\n                setError(error);\r\n            }\r\n        };\r\n        fetchCodeBlock();\r\n\r\n        newSocket.on('codeUpdated', (updatedCode) => {\r\n            setCode(updatedCode);\r\n        });\r\n\r\n        newSocket.on('typing', () => {\r\n            setIsTyping(true);\r\n            setTimeout(() => setIsTyping(false), 2000);\r\n        });\r\n\r\n        return () => {\r\n            newSocket.off('codeUpdated');\r\n            newSocket.off('typing');\r\n            newSocket.disconnect();\r\n        };\r\n    }, [id]);\r\n\r\n    const handleSave = async () => {\r\n        if (user.role !== 'Mentor') {\r\n            try {\r\n                const response = await fetch(`https://mentorship-app.onrender.com/api/codeblocks/${id}`, {\r\n                    method: 'PUT',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                    },\r\n                    body: JSON.stringify({ title, code }),\r\n                });\r\n    \r\n                if (!response.ok) {\r\n                    const errorText = await response.text();\r\n                    throw new Error(`Network response was not ok: ${errorText}`);\r\n                }\r\n                console.log('Code block updated successfully');\r\n                \r\n                if (socket && socket.connected) {\r\n                    socket.emit('updateCode', { code });\r\n                }\r\n                checkCorrectCode();\r\n            } catch (error) {\r\n                console.error('Error updating code block:', error);\r\n                setError(error.message);\r\n            }\r\n        }\r\n    };\r\n\r\n    const checkCorrectCode = async () => {\r\n        const celebrationSpan = document.querySelector('.material-symbols-outlined');\r\n        if (code === correctCode) {\r\n            if (!celebrationSpan) {\r\n                const newSpan = document.createElement('span');\r\n                newSpan.classList.add('material-symbols-outlined');\r\n                newSpan.textContent = \"celebration\";\r\n                document.body.appendChild(newSpan);\r\n                setTimeout(() => {\r\n                    newSpan.remove();\r\n                }, 2000);\r\n            }\r\n           \r\n        } else {\r\n            if (celebrationSpan) {\r\n                celebrationSpan.remove();\r\n            }\r\n        }\r\n    };\r\n    \r\n\r\n    const handleCodeChange = (e) => {\r\n        const updatedCode = e.target.value;\r\n        setCode(updatedCode);\r\n        if (user.role !== 'Mentor') {\r\n            socket.emit('typing');\r\n            socket.emit('updateCode', { code: updatedCode });\r\n        }\r\n    };\r\n\r\n    if (error) return <p>Error loading code block.</p>;\r\n\r\n    return (\r\n        <div>\r\n            <h2>Code Block</h2>\r\n            <h4>{title}</h4>\r\n            {user.role === 'Mentor' ? (\r\n                <div>\r\n                    <SyntaxHighlighter language=\"javascript\" style={docco}>\r\n                        {code}\r\n                    </SyntaxHighlighter>\r\n                    {isTyping && <p>The mentee is typing...</p>}\r\n                </div>\r\n            ) : (\r\n                <div>\r\n                    <textarea rows=\"10\" cols=\"50\" value={code} onChange={handleCodeChange} />\r\n                    <br />\r\n                    <button onClick={handleSave}>Save Changes</button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CodeBlockPage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}